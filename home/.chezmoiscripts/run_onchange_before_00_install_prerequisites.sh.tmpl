#!/usr/bin/env bash
set -eufo pipefail

. "$(chezmoi source-path)/../lib/log.sh"

# sdkman
if [ ! -d "${HOME}/.sdkman" ]; then
  log_info "installing sdkman"
  curl -s "https://get.sdkman.io?rcupdate=false" | bash
  log_info_complete
fi

# homebrew
if ! [ -x "$(command -v brew)" ]; then
  log_info "installing homebrew"
  NONINTERACTIVE=1 /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
  log_info_complete
fi

{{ if not .gitpod -}}
# flatpak
if ! [ -x "$(command -v flatpak)" ]; then
  log_info "installing flatpak"
  sudo apt-get update
  sudo apt-get install -y flatpak
  flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
  log_info_complete
fi
{{ end -}}

